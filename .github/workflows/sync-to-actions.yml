# file: .github/workflows/sync-to-actions.yml
# version: 1.0.0
# guid: s1y2n3c4-5w6o-7r8k-9f0l-1o2w3i4d5e6f

name: Sync to Action Repos

on:
  schedule:
    # Run daily at 6am UTC
    - cron: '0 6 * * *'
  workflow_dispatch:
    inputs:
      repos:
        description: 'Comma-separated list of repos to sync (or "all")'
        required: false
        default: 'all'
      dry_run:
        description: 'Dry run mode (no commits)'
        required: false
        default: 'false'

jobs:
  sync:
    runs-on: ubuntu-latest
    permissions:
      contents: write

    steps:
      - name: Checkout template repo
        uses: actions/checkout@v4
        with:
          path: template

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.13'

      - name: Sync files to action repos
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          DRY_RUN: ${{ github.event.inputs.dry_run || 'false' }}
          TARGET_REPOS: ${{ github.event.inputs.repos || 'all' }}
        run: |
          cd template
          python scripts/sync-to-repos.py
